{% extends 'base_front.html.twig' %}

{% block title %}Les √©quipes de la saison {{ saison.nom }} - BLVB{% endblock %}

{% block body %}
<div class="container mx-auto max-w-5xl px-4">
    <h1>Les √©quipes de la saison {{ saison.nom }}</h1>
    {% for phase in saison.phases%}
        <div class="bg-base-100 border-base-300 collapse {%  if phaseouverte.id==phase.id %}collapse-open {% endif %}collapse-arrow border">
            <input type="checkbox" class="peer" />
            <div class="collapse-title">
                {{ phase.nom }}
            </div>
            <div class="collapse-content">
                <div class="tabs tabs-lift">
                {% for poule in phase.poules %}

                        <input type="radio" name="tabs_{{phase.id}}" class="tab te" aria-label="{{poule.nom}}" {% if loop.index==1 %}checked {% endif%} />
                        <div class="tab-content bg-base-100 border-base-300 p-6">
                        {% if poule.equipes|length ==0 %}
                            <p class="alert alert-info">Aucune √©quipe dans cette poule.</p>
                        {% else %}
                        {# Affichage pour grand √©cran sous forme de table #}
                            <div class="hidden md:block overflow-x-auto">
                                <table class="table table-zebra border border-solid w-full">
                                    <thead> <tr>
                                        <th>Nom</th>
                                        <th>Adresse</th>
                                        <th>Horaire habituel de r√©ception</th>
                                        <th>Classement</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    {% for equipe in poule.equipes %}
                                        <tr>
                                            <td>
                                                <a href="{{path('front_equipe_detail', {'id': equipe.id})}}" class="link font-bold">
                                                    {{ equipe.nom }}
                                                </a>
                                            </td>
                                            <td>
                                                <a class="link" href="https://www.google.com/maps/search/?api=1&query={{ equipe.lieu.adresse|url_encode }}" target="_blank" rel="noopener noreferrer">
                                                    {{ equipe.lieu.nom }}
                                                </a>
                                            </td>
                                            <td>
                                                {% for creneau in equipe.lieu.creneaux %}
                                                    <div class="text-sm">{{creneau.jourLibelle}} - {{creneau.heureDebut|format_time('short', locale='fr')}}</div>
                                                {% endfor %}
                                            </td>
                                            <td class="text-center font-bold">{% for classement in equipe.classements %}
                                                    {% if classement.poule == poule %}{{ classement.position }}{% endif %}{%  endfor %}</td>
                                        </tr>
                                    {% endfor %}
                                    </tbody>
                                </table>
                            </div>
                            {# Affichage pour mobile sous forme de carte #}
                            <div class="md:hidden flex flex-col gap-4 mt-4">
                                {% for equipe in poule.equipes %}
                                    {# J'ai remplac√© w-96 par w-full pour que √ßa s'adapte √† l'√©cran du t√©l√©phone #}
                                    <div class="card w-full bg-base-100 shadow-md border border-base-200">
                                        <div class="card-body p-4"> <div class="flex justify-between items-start">
                                                <a href="{{path('front_equipe_detail', {'id': equipe.id})}}" class="link font-bold">
                                                <h3 class="card-title text-lg">{{equipe.nom}}</h3>
                                                </a>
                                            </div>

                                            <div class="text-sm mt-2">
                                                <p class="font-semibold">üìç Lieu :</p>
                                                <a class="link block truncate" href="https://www.google.com/maps/search/?api=1&query={{ equipe.lieu.adresse|url_encode }}" target="_blank" rel="noopener noreferrer">
                                                    {{ equipe.lieu.nom }}
                                                </a>
                                            </div>

                                            <div class="text-sm mt-2">
                                                <p class="font-semibold">üïí Cr√©neaux :</p>
                                                {% for creneau in equipe.lieu.creneaux %}
                                                    <p>{{creneau.jourLibelle}} √† {{creneau.heureDebut|format_time('short', locale='fr')}}</p>
                                                {% else %}
                                                    <p class="italic text-gray-500">Aucun cr√©neau d√©fini</p>
                                                {% endfor %}
                                            </div>
                                            <div class="text-sm mt-2">
{#                                            <p class="badge badge-primary">Classement : {{equipe.position}}</p>#}
                                            </div>
                                        </div>
                                    </div>
                                {% endfor %}
                            </div>
                        {% endif %}
                        </div>

                {% endfor %}
                </div>
            </div>
        </div>
    {%  endfor %}
    </div>
{% endblock %}
