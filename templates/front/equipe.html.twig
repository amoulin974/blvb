{% extends "base_front.html.twig" %}
{% block title %}Équipe {{equipe.nom}} - Site du BLVB{% endblock %}

{% block body %}
    <div class="container mx-auto max-w-5xl px-4">
        <h1 class="text-center mb-4">{{equipe.nom}}</h1>
        <h2 class="mt-4">Informations générales</h2>
        <p><span class="font-bold">Adresse du gymnase :</span> <a class="link" href="https://www.google.com/maps/search/?api=1&query={{ equipe.lieu.adresse|url_encode }}"
                                            target="_blank"
                                            rel="noopener noreferrer">
                                                {{ equipe.lieu.nom }}
                                            </a></p>
        {% for creneau in equipe.lieu.creneaux %}
            <div class="text-sm">{{creneau.jourLibelle}} - {{creneau.heureDebut|format_time('short', locale='fr')}}</div>
        {% endfor %}
        <p><span class="font-bold">Capitaine :</span>
        {%if not equipe.capitaine %}
            <span class="em">Aucun capitaine défini</span>   </p>
        {% elseif not canViewCapitaine  %}
        <span class="em">Ces information ne sont visibles que par les capitaines d'une équipe évoluant dans la même poule ou les administrateurs du site.</span></p>

        {% else %}
        </p>
        <p><span class="font-bold">Nom :</span>  {{equipe.capitaine.prenom}} {{equipe.capitaine.nom}}</p>
        <p><span class="font-bold">Tel :</span>  {{equipe.capitaine.telephone}} </p>
        <p><span class="font-bold">Email :</span>  {{equipe.capitaine.email}} </p>
        {% endif %}

        <h2 class="mt-4">Calendrier</h2>
        {% for phase in saison.phases %}
            {% for poule in phase.poules %}

                {%  if matchsByPoule[poule.id] is defined and matchsByPoule[poule.id]|length>0 %}
                    <h3 class="mt-2 pl-4 pb-1">{{ phase.nom }} - {{ poule.nom }}</h3>

            <table class="border border-solid table-xs  w-full hidden md:table">
                <thead><tr class="text-center bg-base-300">
                    <th>Date</th>
                    <th>Les équipes</th>
                    <th>Score</th>
                    <th>Le lieu</th>
                </tr></thead>
                <tbody>

                    {%  for match in matchsByPoule[poule.id] %}

                        <tr class="text-center">
                            <td>{{ match.date_match|format_datetime('short', locale='fr') }}</td>
                            <td>{{ match.equipe_recoit }} {{ match.score_reception_match }} vs {{ match.equipe_deplace }} {{ match.score_deplacement_match }}</td>
                            <td>
                                {%  if match.score_reception_match is null and  match.score_deplacement_match is null %}
                                    Match non joué
                                    {% else %}
                                        <div class="flex items-center justify-center"><span>{{ match.score_reception_match }} - {{ match.score_deplacement_match }}</span>
                                            <span>
                                        {% if match.resultat %}
                                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6 text-success">
                                                <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" />
                                            </svg>

                                        {% else %}
                                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6 text-error">
                                                <path stroke-linecap="round" stroke-linejoin="round" d="m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" />
                                            </svg>

                                        {%  endif %}
                                                </span>
                                        </div>
                                {%  endif %}

                            </td>
                            <td>
                                <a class="link" href="https://www.google.com/maps/search/?api=1&query={{ match.lieu_adresse |url_encode }}"
                                   target="_blank"
                                   rel="noopener noreferrer">
                                    {{ match.lieu_nom}}
                                </a>

                            </td>
                        </tr>

                   {% endfor %}

                </tbody>
            </table>
                    {%  for match in matchsByPoule[poule.id] %}
                        <div class="card w-96 bg-base-100 card-xs shadow-sm block md:hidden liste-equipe-mobile mt-1">
                            <div class="card-body " >
                                <p class="flex items-center">{{ match.equipe_recoit }} &nbsp; <strong>{{ match.score_reception_match }}</strong>&nbsp; vs &nbsp; {{ match.equipe_deplace }} &nbsp; <strong>{{ match.score_deplacement_match }}</strong>
                                    {% if match.resultat %}
                                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6 text-success">
                                            <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" />
                                        </svg>

                                    {% else %}
                                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6 text-error">
                                            <path stroke-linecap="round" stroke-linejoin="round" d="m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" />
                                        </svg>

                                    {%  endif %}
                                </p>
                                <p>Date : {{ match.date_match|format_datetime('short', locale='fr') }}</p>
                                <p>Lieu : <a class="link" href="https://www.google.com/maps/search/?api=1&query={{ match.lieu_adresse |url_encode }}"
                                             target="_blank"
                                             rel="noopener noreferrer">
                                        {{ match.lieu_nom}}
                                    </a>
                                    </p>
                            </div>

                        </div>
                    {% endfor %}
            <p>Le fichier ics de ce calendrier : <a class="link" href="{{path("calendar_ics", {poule: poule.id, equipe: equipe.id})}}">Click droit copier l'adresse</a></p>
                <p class="text-xs">Faite un clic droit "copier l'adresse" puis dans google agenda -> le + à coté de Autre Agenda --> A partir de l'URL et copier l'adresse</p>
                {%  endif  %}
            {% endfor %}
    {% endfor %}


        <h2 class="mt-4">Classement de la saison sélectionnée </h2>
        {% for phase in saison.phases %}
            {% for poule in phase.poules %}
                {% if equipe in poule.equipes %}

                <h3 class="mt-2 pl-4 pb-1">{{ phase.nom }} - {{ poule.nom }}</h3>
                                {% include '/front/fragments/_classement_poule_unique.html.twig' with { 'poule': poule, "equipeid": equipe.id } %}
                {% endif %}
            {% endfor %}
        {% endfor %}


    </div>

{% endblock %}
